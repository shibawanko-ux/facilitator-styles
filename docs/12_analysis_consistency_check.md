# 分析結果・エンジニアリングロジック 整合性確認レポート

**確認日**: 2026-01-25

## 1. エンジニアリングロジック確認

### 1.1 質問・軸の対応
- **質問数**: 32問（軸あたり8問）
  - 軸1 介入スタイル: 質問ID 1–8
  - 軸2 知覚対象: 質問ID 9–16
  - 軸3 判断基準: 質問ID 17–24
  - 軸4 場への関わり: 質問ID 25–32
- **結論**: 矛盾なし。

### 1.2 スコアリング
- **範囲**: 各軸 8–48（8問×1〜6）
- **境界**: 中央 28。27以下＝A寄り、28以上＝B寄り
- **型マッピング**:
  - intervention: 低→trigger(触発型), 高→watch(見守型)
  - perception: 低→observe(観察型), 高→insight(洞察型)
  - judgment: 低→goal(目的型), 高→relation(関係型)
  - engagement: 低→design(設計型), 高→improvise(即興型)
- **結論**: types.ts・scoring.ts の定義と一致。矛盾なし。

### 1.3 16スタイル（旧16タイプ）の判定
- **determineType(intervention, perception, judgment, engagement)** で一意に1スタイルを特定
- facilitatorTypes に 2^4=16 通りすべて存在することを確認済み
- **結論**: 矛盾なし。

### 1.4 グループ分類（4塊）とロジックの一致
- 推進者: intervention=trigger, judgment=goal
- 共感者: intervention=trigger, judgment=relation
- 戦略家: intervention=watch, judgment=goal
- 守護者: intervention=watch, judgment=relation
- ResultPage / TypeDetailModal / TopPage の表示ロジックと一致
- **結論**: 矛盾なし。

### 1.5 バグ修正: 最終質問回答後の結果生成
- **事象**: 最後の質問（32問目）に回答して「次へ」を押したとき、`nextQuestion` 内で参照する `answers` がまだ1件足りない（React の state 更新が非同期のため）
- **影響**: 31件の回答で結果が計算され、1軸のスコアが誤る可能性がある
- **対応**: useDiagnosis で `answers` の最新値を ref に保持し、結果画面へ遷移するときに ref の値を使って診断結果を生成するよう修正する

---

## 2. 分析結果の文言・表現の整合性

### 2.1 軸ラベル（4軸）
| 軸 | axisContents label | TOP 4軸カード | ScoreChart | 4象限 |
|---|--------------------|----------------|------------|--------|
| 介入 | 触発型/見守型 | 触発型⇔見守型 | 触発型/見守型 | 介入スタイル: 触発型/見守型 |
| 知覚 | 観察型/洞察型 | 観察型⇔洞察型 | 観察型/洞察型 | 知覚対象: 観察型/洞察型 |
| 判断 | 目的型/関係型 | 目的型⇔関係型 | 目的型/関係型 | 判断基準: 目的型/関係型 |
| 場 | 設計型/即興型 | 設計型⇔即興型 | 設計型/即興型 | 場の関わり: 設計型/即興型 |
- **結論**: すべて一致。矛盾なし。

### 2.2 「タイプ」と「スタイル」の使い分け
- **方針**: TOP で「ファシリテーター16スタイル」に変更済み。スタイル＝得意とする傾向、タイプ＝個々のイメージを避ける。
- **現状の揺れ**:
  1. 結果画面ヒーロー: 「あなたのファシリテーター**タイプ**は...」 → スタイルに統一推奨
  2. TOP 説明文: 「これらの組み合わせから16**タイプ**に判定されます」 → 16**スタイル**に統一推奨
  3. シェア文: 「私は「〇〇」**タイプ**でした」 → **スタイル**に統一推奨
  4. 相性セクション: 「他の**タイプ**との相性」「相性が良い**タイプ**」 → **スタイル**に統一推奨
- **結論**: 表記を「スタイル」に揃える修正を推奨。

### 2.3 その他
- リード文（型×グループ説明）: ResultPage と TypeDetailModal で同一ロジック・同一文言。矛盾なし。
- 4象限の軸名・型ラベル: typeKeywords / axisContents と一致。矛盾なし。

---

## 3. 実施した修正（要約）※すべて実装済み

1. **useDiagnosis.ts**: 最終質問回答後、結果画面へ遷移する際に `answersRef.current` を使って診断結果を生成するよう変更（32件そろった状態で結果が計算されるようにする）
2. **ResultPage.tsx**: 「あなたのファシリテータータイプは」→「あなたのファシリテータースタイルは」に変更
3. **TopPage.tsx**: 「16タイプに判定されます」→「16スタイルに判定されます」に変更
4. **ShareSection.tsx**: シェア文の「〇〇タイプでした」→「〇〇スタイルでした」に変更（2箇所）
5. **ResultPage.tsx（相性）**: 「他のタイプとの相性」「相性が良いタイプ・難しいタイプ」→「他のスタイルとの相性」「相性が良いスタイル・難しいスタイル」、「相性が良いタイプ」見出し→「相性が良いスタイル」に変更

---

## 4. 修正対象外（意図的に維持）

- **TypeDetailModal** 内の「このタイプ」: モーダルでは「このスタイル」より「このタイプ」の方が自然なため維持
- **コード内コメント・変数名**（例: `FacilitatorType`, `result.type`）: 実装用語としてそのまま使用
